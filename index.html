<!doctype html>
<html lang="ko" class="h-full">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ë©”ëª¨ë¦¬ ê²Œì„</title>

<script src="https://cdn.tailwindcss.com/3.4.17"></script>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@600;800&display=swap" rel="stylesheet">

<style>
* { font-family: 'Nunito', sans-serif; }

.card-container { perspective: 1000px; }

.card {
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.5s ease;
}

.card.flipped { transform: rotateY(180deg); }

.card-face {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.card-back {
  background: linear-gradient(135deg, #667eea, #764ba2);
}
.card-back::before {
  content: '?';
  font-size: clamp(1.5rem, 5vw, 2.5rem);
  color: rgba(255,255,255,0.3);
  font-weight: 800;
}

.card-front {
  background: linear-gradient(135deg, #ffecd2, #fcb69f);
  transform: rotateY(180deg);
  font-size: clamp(1.5rem, 5vw, 2.5rem);
}

.card.matched {
  animation: matchPop 0.5s ease forwards;
}

@keyframes matchPop {
  0% { transform: rotateY(180deg) scale(1); }
  50% { transform: rotateY(180deg) scale(1.1); }
  100% { transform: rotateY(180deg) scale(0); opacity: 0; }
}

.time-warning { animation: pulse 1s infinite; }
@keyframes pulse {
  0%,100%{opacity:1;}
  50%{opacity:0.6;}
}

@keyframes trophy-bounce {
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-15px);}
}
.trophy-bounce { animation:trophy-bounce .6s ease; }

.new-record-glow {
  animation: glow 1.5s infinite;
}
@keyframes glow {
  0%,100%{box-shadow:0 0 20px gold;}
  50%{box-shadow:0 0 40px gold;}
}
</style>
</head>

<body class="h-full bg-gradient-to-br from-[#1a1a2e] via-[#16213e] to-[#0f3460] text-white">

<div id="main-menu" class="h-full flex flex-col items-center justify-center gap-4 p-6">
<h1 class="text-5xl font-extrabold">ğŸ§  ë©”ëª¨ë¦¬ ê²Œì„</h1>

<button onclick="startGame('easy')" class="bg-green-500 px-6 py-3 rounded-xl">ì‰¬ì›€</button>
<button onclick="startGame('normal')" class="bg-blue-500 px-6 py-3 rounded-xl">ë³´í†µ</button>
<button onclick="startGame('hard')" class="bg-pink-500 px-6 py-3 rounded-xl">ì–´ë ¤ì›€</button>
<button onclick="startGame('veryhard')" class="bg-yellow-500 px-6 py-3 rounded-xl">ë² ë¦¬í•˜ë“œ</button>
</div>

<div id="game-screen" class="hidden h-full flex flex-col">

<div class="p-3 text-center">
<div id="timer" class="text-xl font-bold">0:00</div>
<div id="moves" class="text-sm">ì‹œë„ 0</div>
</div>

<div class="flex-1 flex items-center justify-center overflow-hidden">
<div id="game-board" class="flex flex-wrap justify-center"></div>
</div>

<div class="p-3 flex gap-3 justify-center">
<button onclick="restartGame()" class="bg-green-500 px-4 py-2 rounded">ë‹¤ì‹œ</button>
<button onclick="goMenu()" class="bg-gray-600 px-4 py-2 rounded">ë©”ë‰´</button>
</div>

</div>

<!-- WIN MODAL -->
<div id="win-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center">
<div class="bg-purple-600 p-8 rounded-3xl text-center w-80">
<div id="trophy" class="text-5xl mb-3 trophy-bounce">ğŸ‰</div>
<h2 class="text-2xl font-bold mb-2">í´ë¦¬ì–´!</h2>

<div id="new-record" class="hidden mb-2 font-bold new-record-glow rounded-full bg-yellow-300 text-yellow-900 px-3 py-1">
ğŸ† NEW RECORD
</div>

<p>ë‚´ ê¸°ë¡: <span id="my-time"></span></p>
<p>ìµœê³  ê¸°ë¡: <span id="best-time"></span></p>

<button onclick="restartGame()" class="mt-4 bg-white text-purple-600 px-4 py-2 rounded">ë‹¤ì‹œí•˜ê¸°</button>
</div>
</div>

<script>
/* ìƒíƒœ */
let cards=[], flipped=[], matched=0, moves=0;
let seconds=0, timer=null, difficulty=null;

const emojis=['ğŸ¦Š','ğŸ¼','ğŸ¦','ğŸ¸','ğŸ¦‹','ğŸŒ¸','â­','ğŸŒˆ','ğŸ','ğŸˆ','ğŸ¸','ğŸ®','ğŸš€','ğŸ°','âš½','ğŸ¨','ğŸ¦’','ğŸ¦“','ğŸ·','ğŸµ'];

const settings={
easy:{pairs:8,cols:4,rows:4},
normal:{pairs:10,cols:5,rows:4},
hard:{pairs:15,cols:6,rows:5},
veryhard:{pairs:20,cols:8,rows:5}
};

/* ê¸°ë¡ */
function getBest(){
return JSON.parse(localStorage.getItem("memory-best")||"{}");
}
function saveBest(t){
const b=getBest();
if(!b[difficulty]||t<b[difficulty]){
b[difficulty]=t;
localStorage.setItem("memory-best",JSON.stringify(b));
return true;
}
return false;
}

/* ì‹œì‘ */
function startGame(d){
difficulty=d;
document.getElementById("main-menu").classList.add("hidden");
document.getElementById("game-screen").classList.remove("hidden");
init();
}

/* ì´ˆê¸°í™” */
function init(){
const s=settings[difficulty];
cards=[...emojis.slice(0,s.pairs),...emojis.slice(0,s.pairs)]
.sort(()=>Math.random()-0.5)
.map(e=>({e,flip:false,match:false}));

flipped=[]; matched=0; moves=0; seconds=0;
clearInterval(timer); timer=null;

render();
update();
}

/* ë°˜ì‘í˜• ë³´ë“œ â­ í•µì‹¬ */
function render(){
const board=document.getElementById("game-board");
board.innerHTML="";

const s=settings[difficulty];

const header=120;
const pad=20;

const w=(window.innerWidth-pad)/s.cols;
const h=(window.innerHeight-header)/s.rows;
const size=Math.floor(Math.min(w,h));

cards.forEach((c,i)=>{
const el=document.createElement("div");
el.className="card-container";
el.style.width=size+"px";
el.style.height=size+"px";

el.innerHTML=`
<div class="card w-full h-full ${c.flip||c.match?'flipped':''} ${c.match?'matched':''}">
<div class="card-face card-back"></div>
<div class="card-face card-front">${c.e}</div>
</div>`;

el.onclick=()=>flip(i);
board.appendChild(el);
});
}

window.addEventListener("resize",()=>difficulty&&render());

/* ë’¤ì§‘ê¸° */
function flip(i){
if(cards[i].flip||cards[i].match||flipped.length>=2) return;

if(!timer){
timer=setInterval(()=>{seconds++;update();},1000);
}

cards[i].flip=true;
flipped.push(i);
render();

if(flipped.length===2){
moves++;
check();
}
}

/* ë§¤ì¹­ */
function check(){
const[a,b]=flipped;
if(cards[a].e===cards[b].e){
cards[a].match=cards[b].match=true;
matched++;
flipped=[];
render();

if(matched===settings[difficulty].pairs){
clearInterval(timer);
win();
}
}else{
setTimeout(()=>{
cards[a].flip=cards[b].flip=false;
flipped=[];
render();
},700);
}
update();
}

/* ìŠ¹ë¦¬ */
function win(){
const isNew=saveBest(seconds);
const best=getBest()[difficulty];

document.getElementById("my-time").innerText=fmt(seconds);
document.getElementById("best-time").innerText=fmt(best);

document.getElementById("new-record").classList.toggle("hidden",!isNew);
document.getElementById("trophy").innerText=isNew?"ğŸ†":"ğŸ‰";

document.getElementById("win-modal").classList.remove("hidden");
}

/* UI */
function fmt(s){
const m=Math.floor(s/60);
const ss=(s%60).toString().padStart(2,"0");
return `${m}:${ss}`;
}

function update(){
document.getElementById("timer").innerText=fmt(seconds);
document.getElementById("moves").innerText="ì‹œë„ "+moves;
}

function restartGame(){
document.getElementById("win-modal").classList.add("hidden");
init();
}

function goMenu(){
clearInterval(timer);
document.getElementById("game-screen").classList.add("hidden");
document.getElementById("main-menu").classList.remove("hidden");
}
</script>

</body>
</html>